---
title: 批量删除git远程已经不存在的本地分支
date: 2024-03-22
tags: [git]
---

## 获取远程仓库的最新信息

首先，我们需要获取远程仓库的最新信息。这是确保我们本地仓库状态与远程仓库同步的关键步骤。我们可以使用 `git fetch` 命令来实现这一点：

```bash
git fetch --force
```

这个命令会强制从远程仓库获取最新的信息。

## 删除远程跟踪的引用

在获取远程仓库的最新信息后，我们可能希望删除那些远程已经不存在的本地远程跟踪的引用。这可以通过使用 `--prune` 选项来实现：

```bash
git fetch --prune
```

这个命令会从本地仓库中删除所有远程仓库已经删除的远程跟踪的引用。这样，我们的本地仓库就不会再跟踪那些已经在远程仓库中删除的分支了。

## 获取远程已经删除但本地仍存在的分支列表

我们可以使用以下命令获取远程仓库已经删除但本地仍存在的分支列表：

```bash
git branch -vv | grep 'origin/.*: gone]' | awk "{print \$1}"
```

如果你的Git设置为中文，那么你需要将 `gone` 换成 `丢失`：

```bash
git branch -vv | grep 'origin/.*: 丢失]' | awk "{print \$1}"
```

这些命令将列出所有远程已经删除但本地仍存在的分支。

## 批量删除分支

有了这个列表后，我们就可以批量删除这些分支了：

```bash
git branch -vv | grep 'origin/.*: 丢失]' | awk "{print \$1}" | xargs git branch -d
```

如果有些分支没有被合并，`git branch -d` 命令可能会失败。如果你想强制删除这些分支，你可以使用 `git branch -D` 命令代替。但是，请谨慎使用此命令，因为它会丢失未合并的更改。
